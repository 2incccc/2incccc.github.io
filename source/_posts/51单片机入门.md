---
title: 51单片机入门
date: 2023-01-20 11:18:17
tags: [电赛,51单片机,Keil]
---
> 课程来源：江科大自化协

## 1 单片机及开发板介绍
### 单片机
* Micro Controller Unit 简称MCU
* 内部集成CPU RAM ROM 定时器 终端系统 通讯接口等一系列常用硬件功能
* 单片机的任务：信息采集、处理和硬件设备的控制
* 学习使用单片机是了解计算机原理与结构的最佳选择

### STC89C52单片机
* 所属系列：51单片机系列
* 公司：STC公司 
* 位数：8位
* RAM：512字节
* ROM：8K
* 工作频率：12MHz
* 是对所有兼容Intel 8031指令系统的单片机的统称

### 命名规则
工作电压、程序空间RAM大小、工作频率、温度范围、封装类型、管脚数

---

## 2 LED
* 2-1 LED点亮
* 2-2 LED闪烁
* 2-3 LED流水灯
&nbsp;
* 延时代码
``` c
void Delay500ms()		//@12.000MHz
{
    unsigned char i, j, k;

    _nop_();
    i = 4;
    j = 205;
    k = 187;
    do
    {
        do
        {
            while (--k);
        } while (--j);
    } while (--i);
}
```
## 3 按键开关
### 3-1 独立按键控制LED亮灭
* 轻触按键：按下开关接通、松开开关断开，原理：金属弹片受力弹动
* 根据原理图，按下按键对应值为0；

#### C51数据运算
* 算术：+, -, *, /, %, = 
* 判断： >, >=, <, <=, ==, !=
* 逻辑: 
  运算符|意义
  --|--
  &&|逻辑与
  \|\||逻辑或
  !|逻辑非
* 位运算
  运算符|意义
  --|--
  <<|按位左移
  \>\>|按位右移
  &|按位与
  \||按位或
  ^|按位异或
  ~|按位去反

#### C51基本语句
`if` `for` `while` `switch`

### 3-2 按键控制LED状态
#### 按键抖动
在开关闭合及断开的瞬间会伴随一连串的抖动
#### 消抖
* 硬件消抖：
  1. RS触发器
  2. 电容器
* 软件消抖
  1. 延时函数
    优点：简单方便
    缺点：程序空跑浪费CPU资源
    ```c
    //@12.000MHz-1ms 延时函数
    void Delay(unsigned int xms){//延时1ms
        unsigned char i, j;
        while(xms--){
            i = 2;
            j = 239;
            do{
                while (--j);
                } while (--i);
            }
    }
    //消抖函数
    void debounce(){
        if(PXin(x)==KEY_PRESS)  //代表按下按键
        Delay(10);  //刚按下时出现抖动，延时10ms
        while(PXin(x)==KEY_PRESS);  //按键闭合，不做处理
        Delay(10);  //按键弹起出现抖动，延时10ms
        /*按键处理*/
    }
    ```
## 4 数码管
### 4-1 静态数码管显示
#### 数码管介绍
* 动态数码管模块原理图
![](https://fastly.jsdelivr.net/gh/2incccc/MyTuTu@main/image/16740367577201674036757125.png)
* 74HC138(U5):
  三线-八线译码器，详见数电课本
* 74HC245(U4)：
  * 作用：双向数据缓冲器，将数据由AX传至BX
  * 原因：单片机驱动能力弱，将驱动改为控制信号，使LED数码管的驱动能力来源VCC
* RP3&4 100R
  * 100欧姆排阻 
  * 作用：分流
* 应用原理
  1. 74HC138译码器，输入三位421二进制数，输出结果作为*位码*
  2. 74HC245，八位输入作为*段码*

#### C51数组
```c
int x[3];   //定义一组变量
int x[]={1,2,3};    //定义一组变量并初始化
```
#### C51子函数
将完成某一功能的程序代码单独抽取出来形成一个模块，在其他函数中可随时调用此模块，以达到代码的复用和优化程序结构的目的。
